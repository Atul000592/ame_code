<html lang="en" xmlns:th="http://www.thymeleaf.org">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="_csrf" th:content="${_csrf.token}" />
<meta name="_csrf_header" th:content="${_csrf.headerName}" />

<head>
	<title>AME DashBoard Controller</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css" />
	<!-- Custom styles for this template -->
	<link rel="stylesheet" href="css/base.css" />
	<link rel="stylesheet" href="css/base-responsive.css" />
	<link rel="stylesheet" href="css/animate.min.css" />
	<link rel="stylesheet" href="css/slicknav.min.css" />
	<link rel="stylesheet" href="css/font-awesome.min.css" />



	<script src="js/local/disable-back-button.js"></script>
	<script src="js/local/resetChangeForget.js"></script>


	<!-- Bootstrap core JavaScript -->
	<script src="vendor/jquery/jquery.min.js"></script>
	<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
	<script src="js/jquery.slicknav.min.js"></script>
	<script src="js/dashboard.js"></script>
	<script src="vendor/jquery-ui/jquery-ui.js"></script>
	





	<!-- Include jQuery -->
	<script src="ame-datatable-js/3.5.1/jquery.min.js"></script>

	<!-- Include DataTables CSS -->
	<link rel="stylesheet" href="ame-datatable-css/1.11.5/jquery.dataTables.min.css">

	<!-- Include DataTables JavaScript -->
	<script src="ame-datatable-js/1.11.5/jquery.dataTables.min.js"></script>

	<!-- Include Select2 CSS -->
	<link href="css/local/select2@4.1.0-rc.0/dist/select2.min.css" rel="stylesheet" />

	<!-- Include Select2 JS -->
	<script src="js/local/select2@4.1.0-rc.0/dist/select2.min.js"></script>




	<style>
		.select-all-checkbox {
           			margin-right: 5px;

		}
		
		label{
		font-weight: 600;
		}
	</style>


	<style>
		.dataTables_wrapper .dataTables_length {
			float: left;
			margin-bottom: 15px;
		}
	</style>

</head>


<body>



	<div class="d-flex" id="wrapper">


		<!-- Sidebar -->
		<div th:replace="~{admin-template/admin-left-menu::admin-left-menu}"></div>
		<!-- /#sidebar-wrapper -->

		<!-- Page Content -->
		<div id="page-content-wrapper">


			<div th:replace="~{admin-template/nav-bar-bda::sidebar-wrapper-menu-nav-bda}"></div>

<br>
			<div class="container">
<span style="margin-top:5px;font-size: 18px;color: blue;">
ADD NEW BOARD MEMEBR TO BOARD
</span>
				<div class="wisecountnactionbg">

					<div id="loading-overlay">
						<div class="spinner"></div>


					</div>

					<input id="boardIdOr" type="hidden" th:value="${boardId}">


					<hr>
					<div class="row d-flex align-items-center">
						<div class="col-md-1">Force :-</div>
						<div class="col-md-3">
							<select id="forceName_id" class="form-select" style="font-size: 14px; padding: 2%;">
								<option value="0">Select</option>
								<option th:each="forceList: ${forceList}" th:value="${forceList.forceNo}"
									th:text="${forceList.forceName}"></option>

							</select>
						</div>
						<div class="col-md-1">

							<label> Unit:- </label>
						</div>
						<div class="col-md-3">

							<span aria-label="Default select example" style="font-size: 14px; padding: 0%;"> <select
									id="unit_Id" class="form-select" style="font-size: 14px; padding: 0%;">
								</select>
							</span>
						</div>

						<div class="col-md-2">
							<label> Attach Unit:- </label>
						</div>
						<div class="col-md-2">

							<span aria-label="Default select example" style="font-size: 12px; padding: 0%;"> <select
									id="attach_unit" class="form-select" style="font-size: 14px; padding: 0%;">
								</select>
							</span>

						</div>
					</div>


					<hr>
					<div class="w-100">
						<h6 style="font-weight: 600;">List of Force Personnel (MEDICAL && DOCTORS`S)</h6>

						<table class="table table-striped table-bordered table-hover" id="unitdatatable"
							style="font-size: 12px; padding: 0%;">
							<thead class="table-light">
								<tr>

									<th>IRLA No</th>
									<th>Name</th>
									<th>Gender</th>
									<th>Designation</th>
									<th>Unit</th>
									<th>Mapped</th>


								</tr>
							</thead>
							<tbody>


							</tbody>
						</table>
						<hr>
						<div class="row">
							<div class="col-md-6">
								<form th:action="@{bda-dashboard}" method="get">
									<input type="submit" value="Back" class="btn btn-primary btn-md sendList">
								</form>

							</div>
							<div class="col-md-6">
								<button class="btn btn-primary btn-md" style="float: right;" type="button"
									id="saveMapping">Submit</button>
							</div>

						</div>


					</div>
					<input type="hidden" id="forceNumber"> <input type="hidden" id="unitNumber">


					<hr>




				</div>


			</div>
			
			<form action="edit-board-details" method="post" class="m-0" id="edit-board-details-redirect">
			<input type="hidden"  id="boardIdId" name="boardId">
			<input type="hidden" th:value="${_csrf.token}" name="_csrf"> 
		</form>

		</div>
		<!-- /#page-content-wrapper -->

	</div>
	<!-- /#wrapper -->
	<!-- Modal -->
	<!-- Modal -->
	<div class="modal fade" id="assignModal" tabindex="-1" role="dialog" aria-labelledby="assignModalLabel"
		aria-hidden="true">
		<div class="modal-dialog modal-lg" role="document"> <!-- Added modal-lg for larger size -->
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="assignModalLabel">Assign Board Member</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<div class="wisecountnactionbg">
						<div id="b-homedb">
							<div class="row">
								<div class="col-md-2">
									<label style="font-size: large; font-weight: bold;">Medical
										Board For : </label>
								</div>
								<div class="col-md-2 text-end">
									<label style="color: darkred;" id="s1"
										th:text="${medicalBoard.gFlag}"></labe>
								</div>
							</div>

							<div class="row">
								<div class="col-md-3">Medical Examination Type :-</div>
								<div class="col-md-1">
									<span id="s1" th:text="${medicalBoard.useFor}"></span>
								</div>
								<div class="col-md-2">Situated At(Place) :-</div>
								<div class="col-md-2">
									<span id="s1" th:text="${medicalBoard.place}"> </span>
								</div>
	
								<div class="col-md-3">Medical Examination Year :-</div>
								<div class="col-md-1">
									<span id="s1" th:text="${medicalBoard.boardYear}"> </span>
								</div>
	
							</div>

							<div class="row">

								<div class="col-md-2">Force Name :-</div>
								<div class="col-md-2">
									<span id="s1" th:text="${medicalBoard.forceName}"></span>
								</div>
								<div class="col-md-2">Constituted On :-</div>
								<div class="col-md-2">
									<span id="s1"
										th:text="${#dates.format(medicalBoard.createdOn,'dd-MM-yyyy')}">
	
									</span>
								</div>
								<div class="col-md-3">Status :-</div>
								<div class="col-md-1">
									<span id="s1" th:text="${medicalBoard.status}"></span>
								</div>
	
							</div>
							<hr>
							<div class="row">
								<div class="col-md-2">
									<label> Constituted By :- </label>
	
								</div>
								<div class="col-md-6">
									<label> <span class="s1" th:text="${createdBy}"></span></label>
								</div>
							</div>
						</div>
					</div>
					<input id="boardId" type="hidden" th:value="${boardId}">
					<input id="forcePersonalId" type="hidden" th:value="${forcePersonalId}">

				</div>
				<br>
				<div class="modal-body">
					<div class="wisecountnactionbg">
						<div id="b-homedb">
							<div class="row">
								<!-- Additional content can go here -->
							</div>

							<div class="row">
								<div class="col-md-2"><label>Name:</label></div>
								<div class="col-md-5">
									<span id="name"></span>
								</div>
								<div class="col-md-3"><label>IRLA /REGT NO:</label></div>
								<div class="col-md-2">
									<span id="irlaNo"></span>
								</div>
							</div>
							<div class="row">
								<div class="col-md-2"><label>Rank/Designation:</label></div>
								<div class="col-md-5">
									<span id="rank"></span>
								</div>
									<div class="col-md-2"><label>Gender:</label></div>
								<div class="col-md-3">
									<span id="gender"></span>
								</div>
							
							</div>

							<div class="row">
								<div class="col-md-3"><label>Unit/Attach Unit:</label></div>
								<div class="col-md-4">
									<span id="unitId"></span> / <span id="attachUnitId"></span>
								</div>
							</div>

							<!-- Checkbox for AME role -->
							<div class="row">
								<div class="col-md-2"><label>Role :</label></div>
								<div class="col-md-10">AMA
									<input type="checkbox" id="roleAme" checked>
									<label for="roleAme"></label>
								</div>
							</div>
						</div>
					</div>
					<input id="boardId" type="hidden" th:value="${boardId}">
					<input id="forcePersonalId" type="hidden" name="forcePersonalId">
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
					<button type="button" class="btn btn-primary" onclick="submitAssignment()">Assign</button>
				</div>

			</div>
		</div>

		<!-- Menu Toggle Script -->
		<script>
			$("#menu-toggle").click(function (e) {
				e.preventDefault();
				$("#wrapper").toggleClass("toggled");
			});



			$(document).ready(function () {
				$('#mappedTable').DataTable();
			});
		</script>


		<script>
			$(document).ready(function () {
				$('#backtotop').click(function () {
					$("html, body").animate({
						scrollTop: 0
					}, 600);
					return false;
				});
			});
		</script>


		<script>
			$('.sub-menu ul').hide();
			$('.sub-sub-menu ul').hide();
			$(".sub-menu a").click(function () {
				$(this).parent(".sub-menu").children("ul").slideToggle("100");
				$(this).find(".right").toggleClass("fa-caret-up fa-caret-down");
			});

			$(".sub-sub-menu a").click(function () {
				$(this).parent(".sub-sub-menu").children("ul").slideToggle("100");
				$(this).find(".right").toggleClass("fa-caret-up fa-caret-down");
			});
		</script>
		<div th:replace="~{medical-sub-ordinate/alert-modal::message-alert-modal}"></div>


		<!-- Signup Modal -->
		<div class="modal fade" id="signout-modal">
			<div class="modal-dialog modal-dialog-centered">
				<div class="modal-content">

					<!-- Modal Header -->
					<div class="modal-header text-center d-block p-5 border-bottom-0">
						<h3 class="modal-title">Sign Out?</h3>
						<button type="button" class="close position-absolute" style="right: 15px; top: 8px;"
							data-dismiss="modal">&times;</button>
					</div>

					<!-- Modal body -->
					<div class="modal-body">
						<p class="text-center">Are you sure you want to Sign Out?</p>
						<div class="text-center py-4">
							<form action="sign-out">
								<button type="submit" class="btn btn-primary b-btn mx-3">Sign
									Out</button>
								<button class="btn btn-secondary mx-3" data-dismiss="modal">Cancel</button>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>




		<script>
			$(function () {
				$("#sortable-menu").sortable();
				$("#sortable-menu").disableSelection();

				$("#sortable-cards").sortable();
				$("#sortable-cards").disableSelection();
			});
		</script>







		<!-- js code  -->


		<script>


			$(document).ready(function () {

				$('#forceName_id').on('change', function () {

					var forceId = $(this).val();
					var token = $("meta[name='_csrf']").attr("content");
					var header = $("meta[name='_csrf_header']").attr("content");
					$.ajax({
						type: 'Post',
						url: 'get-unit-by-forceNo-board',

						data: { forceId: forceId }, beforeSend: function (xhr) {

							xhr.setRequestHeader(header, token);
						},

						success: function (data) {

							createDataForUnit(data.unitList);
							createDataForAttachUnit(data.unitList);


						},
						error: function (e) {



							console.log("ERROR : ", e);

						}
					});
				});

			});


			//====on change boardId get board details====//


			$('#unit_Id').on('change', function () {
				console.log("Unit ID changed");

				var unitId = $(this).val();
				var forceName_id = $("#forceName_id").val();

				var unitType = 1;



				console.log("Unit ID:", unitId);
				console.log("Force Name ID:", forceName_id);

				var token = $("meta[name='_csrf']").attr("content");
				var header = $("meta[name='_csrf_header']").attr("content");


				$.ajax({
					type: "post",
					url: "get-force-personal-by-unit-id-assign-board",
					cache: false,
					dataType: 'json',
					data: {
						queryData: JSON.stringify({ unitNo: unitId, forceNo: forceName_id, unitType: unitType })
					},
					beforeSend: function (xhr) {
						xhr.setRequestHeader(header, token);
					},
					success: function (response) {
						console.log("Ajax success. Response:", response);

						$("#forceNumber").val(response.forceNo);
						$("#unitNumber").val(response.unitId);


						// Destroy the existing DataTable before initializing with new data
						if ($.fn.DataTable.isDataTable("#unitdatatable")) {
							$("#unitdatatable").dataTable().fnDestroy();
							console.log("DataTable destroyed");
						}

						// Initialize DataTable with new data
						$("#unitdatatable").DataTable({
							"scrollX": true, // Enable horizontal scrolling
							"scrollY": "200px", // Enable vertical scrolling with a fixed height
							"data": response.personalResponeseAjax, // Assuming response.data contains your new data
							"columns": [


								{ "data": 'irlaNumber' },
								{ "data": 'name' },
								{ "data": 'gender' },
								{ "data": 'designation' },
								{ "data": 'unitName' },
								{
									"data": null,
									"render": function (data, type, full, meta) {
										return '<button type="button" class="assign-btn" onclick="assignBoardMember(' + data.forcePersonalId + ')">Assign</button>';
									}
								}


							]
						});
						console.log("DataTable initialized with new data");
					},
					error: function (xhr, status, error) {
						console.log("Ajax error:", error);
						alert('Error while request..');
					}
				});



			});



			function assignBoardMember(e) {
				const boardId = $("#boardId").val();
				const forcePersonalId = e;

				var token = $("meta[name='_csrf']").attr("content");
				var header = $("meta[name='_csrf_header']").attr("content");

				$.ajax({
					url: 'get-medical-board',
					type: 'Post',
					data: { boardId: boardId, forcePersonalId: forcePersonalId },
					beforeSend: function (xhr) {
						xhr.setRequestHeader(header, token);
					},
					success: function (response) {

						if (response.medicalBoardData && response.medicalBoardData.length > 0) {
							$('#medicalBoardFlag').text(response.medicalBoardData[0].gazettedFlag);
							$('#medicalExaminationType').text(response.medicalBoardData[0].usedFor);
							$('#medicalBoardPlace').text(response.medicalBoardData[0].place);
							$('#medicalBoardYear').text(response.medicalBoardData[0].boardYear);
							$('#forceName').text(response.medicalBoardData[0].boardAtForceNo);
							$('#constitutedOn').text(response.medicalBoardData[0].createdOn); // Make sure the date format is correct
							$('#status').text(response.medicalBoardData[0].status);
							$('#constitutedBy').text(response.medicalBoardData[0].createdBy);
							if (response.forcePersonnelDto != null) {
								$('#forcePersonalId').val(response.forcePersonnelDto.forcePersonalId);
								$('#name').text(response.forcePersonnelDto.name);
								$('#irlaNo').text(response.forcePersonnelDto.forceId);
								if(response.forcePersonnelDto.unitName!=null)
								 {
									$('#unitId').text(response.forcePersonnelDto.unitName);
								 }
								if(response.forcePersonnelDto.attachUnitName!=null){
									$('#attachUnitId').text(response.forcePersonnelDto.attachUnitName);
								}else{
									$('#attachUnitId').text("N/A");
								}
								$('#rank').text(response.forcePersonnelDto.designation);
								$('#gender').text(response.forcePersonnelDto.gender);

							}
						}

						// Open the modal



						$('#assignModal').modal('show');

					},
					error: function (xhr, status, error) {
						console.error("Error fetching medical board data:", error);
						alert("Failed to fetch medical board details.");
					}
				});
			}


			function submitAssignment() {
    var token = $("meta[name='_csrf']").attr("content");
    var header = $("meta[name='_csrf_header']").attr("content");
    var boardId = $("#boardId").val();
    var forcePersonalId = $("#forcePersonalId").val();

    // Show loading overlay
    $('#loadingOverlay').show();
    console.log('Loading overlay shown');

    $.ajax({
        type: "POST",
        url: "save-board-member",
        cache: false,
        contentType: "application/json",
        data: JSON.stringify({
            boardId: boardId,
            forcePersonalId: forcePersonalId
        }),
        beforeSend: function (xhr) {
            xhr.setRequestHeader(header, token);
        },
        success: function (response) {
            console.log('Success response:', response);
            alert("Data saved successfully!");
        //    $('#successModal').modal('show');  // Show success modal
			$('#loadingOverlay').hide();

            // Forcefully close the 'assignModal'
            $('#assignModal').modal('hide').removeClass('show').attr('aria-hidden', 'true').css('display', 'none');
            console.log('Is assign modal visible after hide?', $('#assignModal').hasClass('show'));
        },
        error: function (jqXHR, textStatus, errorThrown) {
            console.error('AJAX error:', textStatus, errorThrown);
            alert("Failed to save data: " + textStatus);
			$('#loadingOverlay').hide();
        },
        complete: function () {
            // Hide loading overlay
            console.log('Hiding loading overlay');
            //$('#loadingOverlay').hide();

            // Reset form fields (if necessary)
            $('#boardId').val('');
            $('#forcePersonalId').val('');

            // Explicitly close the 'assignModal' if necessary
            console.log('Closing the assign modal');
            $('#assignModal').modal('hide').removeClass('show').attr('aria-hidden', 'true').css('display', 'none');
            console.log('Is assign modal visible after force close?', $('#assignModal').hasClass('show'));
			$('#loadingOverlay').hide();
			 var boardIdOrg = $("#boardIdOr").val();
			$('#boardIdId').val(boardIdOrg);
			$("#edit-board-details-redirect").submit();

        }
    });
}


			//================================ Attach unit Data =============================//


			$('#attach_unit').on('change', function () {
				console.log("Unit ID changed");

				var unitId = $(this).val();
				var forceName_id = $("#forceName_id").val();

				var unitType = 1;



				console.log("Unit ID:", unitId);
				console.log("Force Name ID:", forceName_id);

				var token = $("meta[name='_csrf']").attr("content");
				var header = $("meta[name='_csrf_header']").attr("content");


				$.ajax({
					type: "post",
					url: "get-force-personal-by-attach-unit-id-assign-board",
					cache: false,
					dataType: 'json',
					data: {
						queryData: JSON.stringify({ unitNo: unitId, forceNo: forceName_id, unitType: unitType })
					},
					beforeSend: function (xhr) {
						xhr.setRequestHeader(header, token);
					},
					success: function (response) {
						console.log("Ajax success. Response:", response);

						$("#forceNumber").val(response.forceNo);
						$("#unitNumber").val(response.unitId);


						// Destroy the existing DataTable before initializing with new data
						if ($.fn.DataTable.isDataTable("#unitdatatable")) {
							$("#unitdatatable").dataTable().fnDestroy();
							console.log("DataTable destroyed");
						}

						// Initialize DataTable with new data
						$("#unitdatatable").DataTable({
							"scrollX": true, // Enable horizontal scrolling
							"scrollY": "200px", // Enable vertical scrolling with a fixed height
							"data": response.personalResponeseAjax, // Assuming response.data contains your new data
							"columns": [


								{ "data": 'irlaNumber' },
								{ "data": 'name' },
								{ "data": 'gender' },
								{ "data": 'designation' },
								{ "data": 'unitName' },
								{
									"data": null,
									"render": function (data, type, full, meta) {
										return '<button type="button" class="assign-btn" onclick="assignBoardMember(' + data.forcePersonalId + ')">Assign</button>';
									}
								}


							]
						});
						console.log("DataTable initialized with new data");
					},
					error: function (xhr, status, error) {
						console.log("Ajax error:", error);
						alert('Error while request..');
					}
				});



			});









			//get Mapped member data by boardid

			$('#boardId').on('change', function () {
				var boardId = $(this).val();
				var token = $("meta[name='_csrf']").attr("content");
				var header = $("meta[name='_csrf_header']").attr("content");


				$.ajax({

					type: "post",

					url: "get-mapped-data-by-boardId",
					cache: false,
					dataType: 'json',

					data: { boardId: boardId },
					beforeSend: function (xhr) {

						xhr.setRequestHeader(header, token);
					},
					success: function (response) {
						if (response.isValid) {
							$('#alert-modal .modal-title').text('Success');
							$('#alert-modal .modal-body h3').text(response.message);

							$('#alert-modal .modal-body i').removeClass('fas fa-exclamation-circle fa-lg animate__animated animate__shakeX')
								.addClass('fas fa-check-circle faa-tada animated')
								.removeAttr('style');

							$("#cross-close-button").attr('onclick', 'backToHome()');
							$("#okay-close-button").attr('onclick', 'backToHome()');
							$('#alert-modal').modal({
								backdrop: 'static',
								keyboard: false
							});
							$('#alert-modal').modal('show');

						}

						if ($.fn.DataTable.isDataTable("#mappedTable")) {
							$("#mappedTable").dataTable().fnDestroy();
							console.log("Mapped DataTable destroyed .....");
						}
						$("#mappedTable").DataTable({
							"scrollX": true, // Enable horizontal scrolling
							"scrollY": "200px", // Enable vertical scrolling with a fixed height
							"data": response, // Assuming response.data contains your new data
							"columns": [
								{
									"data": null, "render": function (data, type, full, meta) {
										return meta.row + 1; // Add 1 to meta.row to start numbering from 1
									}
								},
								{ "data": 'forceName' },
								{ "data": 'irlaNumber' },
								{ "data": 'name' },
								{ "data": 'gender' },
								{ "data": 'designation' },
								{ "data": 'unitName' },

							]
						});


						$("#forceName_id").value = "";



					},
					error: function () {
						alert('Error while request..');
					}
				});
			});


			/*-- mapped data----*/

			$(document).ready(function () {
				$("#saveMapping").click(function () {
					$('#loading-overlay').show();
					$('body').addClass('loading');
					var arr = new Array();
					var Myarray = new Array();
					var board_id_a = $("#boardId").val();
					const unitId = $("#unit_Id").val();
					const attachedUnitId = $("#attach_unit").val();


					if (board_id_a == 0) {
						//alert("Please select board Id ");
						return false;
					}

					var forceNumber = $("#forceNumber").val();
					var unitNumber = $("#unitNumber").val();
					var table = document.getElementById("unitdatatable");
					var myTable = document.getElementById("myTable");

					var token = $("meta[name='_csrf']").attr("content");
					var header = $("meta[name='_csrf_header']").attr("content");
					$.each($("input[name='candidateId']:checked"), function () {

						arr.push($(this).val());

					});
					if (arr.length == 0) {
						alert("please select atleast one person for mapping...");
						return false;

					}
					arr.push(board_id_a);
					arr.push(forceNumber);
					arr.push(unitNumber);

					var data = JSON.stringify(arr);


					$.ajax({

						type: "post",

						url: "send-request-to-map-forcepersonal-to-board",
						cache: false,
						dataType: 'json',
						contentType: "application/json",
						data: data,
						beforeSend: function (xhr) {

							xhr.setRequestHeader(header, token);
						},
						success: function (response) {
							if (response.isValid) {
								$('#alert-modal .modal-title').text('Success');
								$('#alert-modal .modal-body h3').text(response.message);

								$('#alert-modal .modal-body i').removeClass('fas fa-exclamation-circle fa-lg animate__animated animate__shakeX')
									.addClass('fas fa-check-circle faa-tada animated')
									.removeAttr('style');

								/* $("#cross-close-button").attr('onclick', 'backToHome()');
								   $("#okay-close-button").attr('onclick', 'backToHome()'); */
								$('#alert-modal').modal({
									backdrop: 'static',
									keyboard: false
								});
								$('#alert-modal').modal('show');
								if ($.fn.DataTable.isDataTable("#mappedTable")) {
									$("#mappedTable").dataTable().fnDestroy();
									console.log("Mapped DataTable destroyed .....");
								}
								$("#mappedTable").DataTable({
									"scrollX": true, // Enable horizontal scrolling
									"scrollY": "200px", // Enable vertical scrolling with a fixed height
									"data": response, // Assuming response.data contains your new data
									"columns": [
										{
											"data": null, "render": function (data, type, full, meta) {
												return meta.row + 1; // Add 1 to meta.row to start numbering from 1
											}
										},
										{ "data": 'forceName' },
										{ "data": 'irlaNumber' },
										{ "data": 'name' },
										{ "data": 'gender' },
										{ "data": 'designation' },
										{ "data": 'unitName' },

									]
								});


								// Destroy the existing DataTable before initializing with new data

								var table = document.getElementById("unitdatatable");
								while (table.rows.length > 0) {
									table.deleteRow(0);
								}

								if (attachedUnitId) {

									$("#boardId").val(board_id_a).trigger('change');
									$("#forceNumber").val(forceNumber).trigger('change');
									$("#unit_Id").val(unitId).trigger('change');
									$("#attach_unit").val(attachedUnitId).trigger('change');
								}
								else {
									$("#boardId").val(board_id_a).trigger('change');
									$("#forceNumber").val(forceNumber).trigger('change');
									$("#unit_Id").val(unitId).trigger('change');
								}
							}



						}, complete: function () {
							$('#loading-overlay').hide();
							$('body').removeClass('loading');
						},
						error: function () {
							alert('Error while request..');
						}
					});


				});
			});




			function createDataForUnit(data) {

				const dropdown = document.getElementById("unit_Id");
				dropdown.innerHTML = "";
				const option = document.createElement("option");
				option.text = 'Select';
				option.value = 0;
				// !-- option.setAttribute("data", data[i].forceId)-->
				dropdown.appendChild(option);
				for (let i = 0; i < data.length; i++) {
					const option = document.createElement("option");
					option.text = data[i].unitName;
					option.value = data[i].unitId;
					// !-- option.setAttribute("data", data[i].forceId)-->
					dropdown.appendChild(option);
				}
			}

			function createDataForAttachUnit(data) {

				const dropdown = document.getElementById("attach_unit");
				dropdown.innerHTML = "";
				const option = document.createElement("option");
				option.text = 'Select';
				option.value = 0;
				// !-- option.setAttribute("data", data[i].forceId)-->
				dropdown.appendChild(option);
				for (let i = 0; i < data.length; i++) {
					const option = document.createElement("option");
					option.text = data[i].unitName;
					option.value = data[i].unitId;
					// !-- option.setAttribute("data", data[i].forceId)-->
					dropdown.appendChild(option);
				}
			}






		</script>



		<script>
			$(document).ready(function () {
				var table = $('#unitdatatable').DataTable();


				// Handle the Select All checkbox
				$('#select-all').on('click', function () {
					var isChecked = $(this).prop('checked');
					// Ensure DataTable is re-initialized before selecting checkboxes
					if ($.fn.DataTable.isDataTable('#unitdatatable')) {
						var table = $('#unitdatatable').DataTable();
						table.rows().nodes().to$().find('input[type="checkbox"]').prop('checked', isChecked);
						var rowCount = table.data().count();
						console.log('Total number of rows:', rowCount);
					}
				});
				// Handle row checkbox changes
				$('#unitdatatable tbody').on('change', 'input[type="checkbox"]', function () {
					var totalCheckboxes = $('#unitdatatable tbody input[type="checkbox"]').length;
					var checkedCheckboxes = $('#unitdatatable tbody input[type="checkbox"]:checked').length;
					$('#select-all').prop('checked', totalCheckboxes === checkedCheckboxes);
				});


			});



			$(document).ready(function () {
				$('#attach_unit').select2();
			});

			$(document).ready(function () {
				$('#unit_Id').select2();
			});








		</script>
		<script>
			// Add this script
			document.querySelector('.btn-secondary').addEventListener('click', function () {
				$('#assignModal').modal('hide');
			});


		</script>
</body>

</html>