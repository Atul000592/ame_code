<html lang="en" xmlns:th="http://www.thymeleaf.org">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="_csrf" th:content="${_csrf.token}"/>
<meta name="_csrf_header" th:content="${_csrf.headerName}"/>



<title>AME</title>

<head>

	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css" />
	<!-- Custom styles for this template -->
	<link rel="stylesheet" href="css/base.css" />
	<link rel="stylesheet" href="css/base-responsive.css" />
	<link rel="stylesheet" href="css/animate.min.css" />
	<link rel="stylesheet" href="css/slicknav.min.css" />
	<link rel="stylesheet" href="css/font-awesome.min.css" />
	<link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">



	<script src="vendor/charts/Chart.js"></script>
	<script src="vendor/charts/moment.min.js"></script>
	<script src="vendor/charts/Chart.min.js"></script>
	<script src="vendor/charts/utils.js"></script>
		<script src="vendor/jquery/jquery.min.js"></script>
	<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
	<script src="js/jquery.slicknav.min.js"></script>
	<script src="js/dashboard.js"></script>
	<script src="js/local/resetChangeForget.js"></script>
	
	</head>
	<style>
		.main-container{
			margin-top: 7%;
			margin-left: 3%;
			background-color: beige;
		}
		label{
			font-weight:600;
			font-family: 'Courier New', Courier, monospace;
		}
		
		table {
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

td, th {
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
}

tr:nth-child(even) {
  background-color: #dddddd;
}
	</style>
	
	<body>
		<div class="container">
			<h4>
				List of Personal (Assign AMA) 
			</h4>
			<h2>HTML Table</h2>

<table>
	<thead>
		<tr>
			<th>Transtional Id: </th>
		     <th colspan="3" th:text="${transationalId}"> </th>
               
		</tr>
		<tr>
			<th>IRLA No</th>
			<th>NAME</th>
			<th>FORCE No</th>
			<th>UNIT</th>
		</tr>
	</thead>
      <tr th:each="dataList: ${fPNgoAmaList}">
	  <td th:text="${dataList.forcePersonalId}"></td>
	  <td th:text="${dataList.name}"></td>
	  <td th:text="${dataList.force_no}"></td>
	  <td th:text="${dataList.unit}"></td>
	</tr>
</table>

			
		</div>
		
		<div class="main-container">
			<h5>Controller panel</h5>
            <div class="row">
           <div class="col-md-2">
			<label>
				Select Force Name:-
			</label>
		</div>
		<div class="col-md-2">
			<select id="forceName_id" style="width:200px" class="form-select form-select-lg mb-3">
				<option value="0">Select
			    </option>
				<option th:each="forceList: ${forceList}" th:value="${forceList.forceId}" th:text="${forceList.forceName}">
				</option>
			</select>
		</div>
		<div class="col-md-2">
			<label>
				Select Unit:-
			</label>
		</div>
		<div class="col-md-2">
			<label>
				<span class="form-select" aria-label="Default select example">
					<select id="unit_Id" style="width:200px">
				</select>
				</span>
			</label>
		</div>
		<div class="col-md-2">
			<label>
				Select AMA:-
			</label>
		</div>
		<div class="col-md-2">
			<label>
				<span id="amaName_id"></span>
				
			</label>
		</div>
		<div class="row">
			<div class="col-md-6">
				<button id="save_data">
					Save Ama
				</button>
			</div>
			<div class="col-md-6">
				<button id="terminate_data">
					Terminate
				</button>
			</div>
		</div>
		</div></div>
	<form id="form_save" method="post" action="send-list-to-ngo-ama">
		<input type="hidden" id="ameForcePersonalId" name="amaForcePersonalId">
		<input type="hidden" id="controllingForcePersonalId"  name="controllingForcePersonalId" th:value="${controllingForcePersonalId}">
		<input type="hidden" id="boardId" name="boardId">
		<input type="hidden" id="transatinalId" name="transatinalId"  th:value="${transationalId}">
	</form>
	
	<form id="form_terminate" method="post" accept="terminate-data-save-in-ngo-list">
		<input type="hidden" id="transatinalId" name="transatinalId"  th:value="${transationalId}">
	</form>
	</body>
	
	<script>
		
$(document).ready(function () {
	 $("#save_data").hide();
	  $("#terminate_data").hide();
	 
			
 $('#forceName_id').on('change', function(){
		var forceId = $(this).val();
		
		  document.getElementById("boardId").value='';
	         document.getElementById("ameForcePersonalId").value='';
			var token = $("meta[name='_csrf']").attr("content");
            var header = $("meta[name='_csrf_header']").attr("content");
		$.ajax({
			type: 'Post',
			url: 'get-unit-by-forceNo',
			data : {forceId : forceId},beforeSend: function( xhr ) {
					
                 xhr.setRequestHeader(header, token);
                                            },
				
			success: function(data) {
				
				
				 const dropdown = document.getElementById("unit_Id");
	             dropdown.innerHTML="";
	              const option = document.createElement("option");
	            	  option.text = 'Select';
	            	  option.value = 0;
	            	// !-- option.setAttribute("data", data[i].forceId)-->
	            	  dropdown.appendChild(option);
	            for (let i = 0; i < data.length; i++) {
	            	  const option = document.createElement("option");
	            	  option.text = data[i].unitName;
	            	  option.value = data[i].unitId;
	            	// !-- option.setAttribute("data", data[i].forceId)-->
	            	  dropdown.appendChild(option);
	            	}
				
			},
			 error: function (e) {

	            

	            console.log("ERROR : ", e);
	            
	        }
		});
	});
	
	
	//get the Ama Name and it information
	
	
	 $('#unit_Id').on('change', function(){
		var unitId = $(this).val();
		var forceName_id=$("#forceName_id").val();
        	var token = $("meta[name='_csrf']").attr("content");
            var header = $("meta[name='_csrf_header']").attr("content");
          $.ajax({
			type: 'Post',
			url: 'get-ama-by-force-unit',
			data : {forceId : forceName_id,unitId:unitId},beforeSend: function( xhr ) {
					
                 xhr.setRequestHeader(header, token);
                                            },
				
			success: function(data) 
			{
				if(data['amaForcePersonalId']!=null){
				
             document.getElementById("boardId").value=data['boardId'];
	         document.getElementById("ameForcePersonalId").value=data['amaForcePersonalId'];
	         document.getElementById("amaName_id").innerHTML ="Name "+data['amaName']+" ForcePersonalId "+data['amaForcePersonalId'];
	         $("#save_data").show();
	             $("#terminate_data").hide();
	         
	      }
	      else{
			   document.getElementById("amaName_id").innerHTML ="No Ama Found for the selected NGO Personals";
			    $("#save_data").hide();
			    $("#terminate_data").show();
		  }
	        
	      
	            
          	},
			 error: function (e) {

   console.log("ERROR : ", e);
	            
	        }
		});
	});
	
	// save the data 
	 $('#save_data').on('click', function(){
		 alert("save data to the board mamber mapping table...");
		
		
		 $("#form_save").submit();
	 });
	 
	 
	 // terminate the process of saving
	 
	  $('#terminate_data').on('click', function(){
		 alert("terminate the  data to the board mamber mapping table...");
		
		 $("#form_terminate").submit();
	 });
	

	});
		
</script>

</html>