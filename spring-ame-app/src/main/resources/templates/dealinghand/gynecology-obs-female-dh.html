<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
<title>AME DashBoard Controller</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="_csrf" th:content="${_csrf.token}" />
<meta name="_csrf_header" th:content="${_csrf.headerName}" />

<link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css" />
<!-- Custom styles for this template -->

<link
	href="css/local/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" />

	<script src="js/local/disable-back-button.js"></script>


<!--  <script>
    history.pushState(null, null, location.href);
    window.onpopstate = function () {
        history.go(1);
    };
</script> -->


</head>


<body>

<div th:replace="~{medical-sub-ordinate/master-doc::master-wrapper-doc}"></div>


	<!-- wrapper -->
	<div class="d-flex" id="wrapper">

		<!-- Sidebar -->
		<div th:replace="~{dealinghand/left-menu-dh::sidebar-wrapper-menu-dh}"></div>
			<!-- /#sidebar-wrapper -->

		<!-- Page Content wrapper -->
		<div id="page-content-wrapper">

		<div th:replace="~{medical-sub-ordinate/nav-bar::sidebar-wrapper-menu-nav-ama}"></div>


			<div class="container mt-3">
				<div class="wisecountnactionbg">

      <div th:replace="~{medical-sub-ordinate/inner-user-details::sidebar-wrapper-inner-user-details}"></div>
					






					<div id="loading-overlay">
						<div class="spinner"></div>


					</div>


					<div class="proc-box py-2 px-3 text-start">


						<form id="regForm" method="Post">

							<h5>Gynecology & Obstetrics (Female)</h5>
							<hr>
							<input type="hidden" th:value="${_csrf.token}" name="_csrf">
							<!-- One "tab" for each step in the form: -->

							<div class="row mb-3">


								<label class="col-sm-2 col-form-label">LMP</label>
								<div class="col-sm-4">
									<input type="date" placeholder="bodyBuild"
										class="form-control col-sm-12"
										th:field="*{gynaeAndObsFemaledata.lmp}"
										> <span
										id="lmp_error" class="error"></span>
								</div>

								<label class="col-sm-2 col-form-label">Menstrual History</label>
								<div class="col-sm-4">
									<input type="text" class="form-control col-sm-12"
										th:field="*{gynaeAndObsFemaledata.menstrualHistory}">
									<span id="menstrualHistory_error" class="error"></span>
								</div>


							</div>


							



							<div class="row mb-3">

								<label class="col-sm-2 col-form-label">Vaginal
									Discharge(if any)</label>
								<div class="col-sm-4">
									<input type="text" class="form-control"
										th:field="*{gynaeAndObsFemaledata.vaginalDischarge}">

									<span id="vaginalDischarge_error" class="error"></span>

								</div>

								<label class="col-sm-2 col-form-label">UV Prolapse,(if
									any)</label>
								<div class="col-sm-4">
									<input type="text" class="form-control"
										th:field="*{gynaeAndObsFemaledata.uvProlapse}"> <span
										id="uvProlapse_error" class="error"></span>

								</div>


							</div>

							<div class="row mb-3">
								<label class="col-sm-2 col-form-label">USG abdomen,(if
									any)</label>
								<div class="col-sm-4">
									<input type="text" class="form-control"
										th:field="*{gynaeAndObsFemaledata.usgAbdomen}"> <span
										id="usgAbdomen_error" class="error"></span>

								</div>

								<label class="col-sm-2 col-form-label">Other ailment,(if
									any)</label>
								<div class="col-sm-4">
									<input type="text" class="form-control"
										th:field="*{gynaeAndObsFemaledata.otherAilment}"> <span
										id="otherAilment_error" class="error"></span>

								</div>





							</div>

							<div class="row mb-3">

								<label class="col-sm-2 col-form-label">Obstetrics
									History(If Any) </label>

								<div class="col-sm-4">
									<input type="text" class="form-control col-sm-12"
										th:field="*{gynaeAndObsFemaledata.obstetricsHistory}"
										id="obstetricsHistory"> <span
										id="obstetricsHistory_error" class="error"></span>

								</div>

								<label class="col-sm-2 col-form-label">Date of last
									confinement</label>
								<div class="col-sm-4">
									<input type="date" class="form-control"
										th:field="*{gynaeAndObsFemaledata.dateOfLastConfinement}"
										onchange="checkDateOfLastConfinement()"
										id="dateOfLastConfinement"
										th:max="${#dates.format(#dates.createNow(),'yyyy-MM-dd')}">
									<span id="dateOfLastConfinement_error" class="error"></span>

								</div>




							</div>



							


							<input type="hidden" th:value="${ameId}" name="ameId" id="ameId">
							<input type="hidden" th:value="${forcepersonalId}"
								name="forcepersonalId">
							<hr>
							<div class="button-div">
								<input type="button" class="btn btn-secondary button2"
									onclick="backToHome()" value="Back"> <input
									type="submit" class="btn btn-success button1  float-end" value="Submit">


							</div>

						</form>
						<form th:action="@{/declaration-requests-completed-ma}" method="post"
							id="back-to-home">
							<input type="hidden" name="forcepersonalId"
								th:value="${forcepersonalId}"> <input type="hidden"
								name="ameId" th:value="${ameId}">

						</form>





<div th:replace="~{medical-sub-ordinate/alert-modal::message-alert-modal}"></div>
				
		</div>
	<!-- /#page-content-wrapper -->

	</div>
	<!-- /#wrapper -->

	<script>
		document.addEventListener("DOMContentLoaded", function() {
			setDefaultValues();
			});
	</script>

	<script>
		function selectedValue() {
			var value = $("#gCategory").val();
			if (value =='G-1') {

				$("#gType").hide();
				$("#gDuration").hide();
				
			} else {
				$('#gType').show();
				$('#gDuration').show();
			}

		}
	</script>
	
	<script>
		function backToHome() {

			$("#back-to-home").submit();
		}
	</script>

	

	<!-- Menu Toggle Script -->
	<script>
		$("#menu-toggle").click(function(e) {
			e.preventDefault();
			$("#wrapper").toggleClass("toggled");
		});
	</script>

	<script>
		document.addEventListener("DOMContentLoaded", function() {
			setDefaultValues();
		});
	</script>

	<script>
		$(document).ready(function() {
			$('#backtotop').click(function() {
				$("html, body").animate({
					scrollTop : 0
				}, 600);
				return false;
			});
		});
	</script>


				<script>
					$('.sub-menu ul').hide();
					$('.sub-sub-menu ul').hide();
					$(".sub-menu a").click(
							function() {
								$(this).parent(".sub-menu").children("ul")
										.slideToggle("100");
								$(this).find(".right").toggleClass(
										"fa-caret-up fa-caret-down");
							});

					$(".sub-sub-menu a").click(
							function() {
								$(this).parent(".sub-sub-menu").children("ul")
										.slideToggle("100");
								$(this).find(".right").toggleClass(
										"fa-caret-up fa-caret-down");
							});
				</script>



				<!-- Signup Modal -->

				<div class="modal fade" id="signout-modal" data-bs-backdrop="static"
					data-bs-keyboard="false" tabindex="-1"
					aria-labelledby="staticBackdropLabel" aria-hidden="true">
					<div class="modal-dialog modal-lg modal-dialog-centered">
						<div class="modal-dialog">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title">Sign Out?</h5>

									<button type="button" class="btn-close" data-bs-dismiss="modal"
										aria-label="Close"></button>
								</div>
								<!-- Modal body -->
								<div class="modal-body">
									<p class="text-center">Are you sure you want to Sign Out?</p>
									<form action="sign-out">
										<div class="row">
											<div class="col-md-6">
												<button type="submit" class="btn btn-primary">Sign
													Out</button>
											</div>
											<div class="col-md-6">
												<button type="button" class="btn btn-secondary"
													data-bs-dismiss="modal">Cancel</button>
											</div>

										</div>

									</form>

								</div>
							</div>
						</div>
					</div>
				</div>



	<script src="vendor/jquery-ui/jquery-ui.js"></script>
	<script>
		document.addEventListener("DOMContentLoaded", function() {
			selectedValue();
			
		});
		</script>
	
	
	<script>
		$(function() {
			$("#sortable-menu").sortable();
			$("#sortable-menu").disableSelection();

			$("#sortable-cards").sortable();
			$("#sortable-cards").disableSelection();
		});
	</script>


	<script>
		$(function() {
			$("#one-item-row").on("click", function() {
				$(".b-customize").addClass("col-lg-12", 300);
				$(".b-customize").removeClass("col-lg-4", 300);
				$(".b-customize").removeClass("col-lg-6", 300);

			});

			$("#two-item-row").on("click", function() {
				$(".b-customize").addClass("col-lg-6", 300);
				$(".b-customize").removeClass("col-lg-4", 300);
				$(".b-customize").removeClass("col-lg-12", 300);

			});

			$("#three-item-row").on("click", function() {
				$(".b-customize").addClass("col-lg-4", 300);
				$(".b-customize").removeClass("col-lg-6", 300);
				$(".b-customize").removeClass("col-lg-12", 300);

			});

		});
	</script>
	<script>
		var currentTab = 0; // Current tab is set to be the first tab (0)
		showTab(currentTab); // Display the current tab

		function showTab(n) {
			// This function will display the specified tab of the form...
			var x = document.getElementsByClassName("tab");
			x[n].style.display = "block";
			//... and fix the Previous/Next buttons:

			if (n == 0) {
				document.getElementById("prevBtn").style.display = "none";
			} else {
				document.getElementById("prevBtn").style.display = "inline";
			}
			if (n == (x.length - 1)) {
				document.getElementById("nextBtn").innerHTML = "Submit";
			} else {
				document.getElementById("nextBtn").innerHTML = "Next";
			}
			//... and run a function that will display the correct step indicator:
			fixStepIndicator(n);
			fixTabIndicator(n)
		}

		function nextPrev(n) {
			// This function will figure out which tab to display
			var x = document.getElementsByClassName("tab");
			// Exit the function if any field in the current tab is invalid:
			if (n == 1 && !validateForm())
				return false;
			// Hide the current tab:
			x[currentTab].style.display = "none";
			// Increase or decrease the current tab by 1:
			currentTab = currentTab + n;
			// if you have reached the end of the form...
			if (currentTab >= x.length) {
				// ... the form gets submitted:
				document.getElementById("regForm").submit();
				return false;
			}
			// Otherwise, display the correct tab:
			showTab(currentTab);
		}

		function validateForm() {
			// This function deals with validation of the form fields
			var x, y, i, valid = true;
			x = document.getElementsByClassName("tab");
			y = x[currentTab].getElementsByTagName("input");
			// A loop that checks every input field in the current tab:
			for (i = 0; i < y.length; i++) {
				// If a field is empty...
				if (y[i].value == "") {
					// add an "invalid" class to the field:
					y[i].className += " invalid";
					// and set the current valid status to false
					valid = false;
				}
			}
			// If the valid status is true, mark the step as finished and valid:
			if (valid) {
				document.getElementsByClassName("step")[currentTab].className += " finish";
			}
			return valid; // return the valid status
		}

		function fixStepIndicator(n) {
			// This function removes the "active" class of all steps...
			var i, x = document.getElementsByClassName("step");
			for (i = 0; i < x.length; i++) {
				x[i].className = x[i].className.replace(" active", "");
			}
			//... and adds the "active" class on the current step:
			x[n].className += " active";
		}
		function fixTabIndicator(n) {
			// This function removes the "active" class of all steps...
			var i, x = document.getElementsByClassName("tabstatus");
			for (i = 0; i < x.length; i++) {
				x[i].className = x[i].className.replace(" active", "");
			}
			//... and adds the "active" class on the current step:
			x[n].className += " active";
		}
	</script>
	<script>
		function selectValue(e) {
			var i = e.value;
			alert(i);
		}
	</script>
	
	
	<!-- ===============================================RK=================================================================== -->
<script>
	$(document).ready(function() {
		$('#regForm').submit(function(event) {
			 event.preventDefault();
			 var ameId=$("#ameId").val();
				var  menstrualHistory=$("#menstrualHistory").val();
				var  lmp=$("#lmp").val();
                var  dateOfLastConfinement=$("#dateOfLastConfinement").val();
				var  vaginalDischarge=$("#vaginalDischarge").val();
				var  uvProlapse=$("#uvProlapse").val();
				var  usgAbdomen=$("#usgAbdomen").val();
				var  otherAilment=$("#otherAilment").val();
				var obstetricsHistory=$("#obstetricsHistory").val();
				
		    
			var formData={
					ameId:ameId,
					menstrualHistory:menstrualHistory,
					lmp:lmp,
	                dateOfLastConfinement:dateOfLastConfinement,
					vaginalDischarge:vaginalDischarge,
					uvProlapse:uvProlapse,
					usgAbdomen:usgAbdomen,
					otherAilment:otherAilment,
					obstetricsHistory:obstetricsHistory,
					

					
			};

			/* ===================header==================== */
			var token = $("meta[name='_csrf']").attr("content");
			var header = $("meta[name='_csrf_header']").attr("content");
			/* ===============clearing previous error message============ */
			$('.error').text('');
			
			
			/* =====================Spinner================= */
              $('#loading-overlay').show();
			  $('body').addClass('loading');


			$.ajax({
				type: 'POST',
				url: 'validate-and-save-gynaecology-dealing-hand',
				data:JSON.stringify(formData),
				contentType: 'application/json',
				async:true,
				beforeSend: function(xhr) {
					xhr.setRequestHeader(header, token);
				},
				success: function(response) {
					
					 

					if (response.isValid) {
						 $('#alert-modal .modal-title').text('Success');
				            $('#alert-modal .modal-body h3').text(response.message);
				            
				            $('#alert-modal .modal-body i').removeClass('fas fa-exclamation-circle fa-lg animate__animated animate__shakeX')
				                                             .addClass('fas fa-check-circle faa-tada animated')
				                                             .removeAttr('style');
				            
				            $("#cross-close-button").attr('onclick', 'backToHome()');
				            $("#okay-close-button").attr('onclick', 'backToHome()');
				            $('#alert-modal').modal({
				                backdrop: 'static',
				                keyboard: false
				              });
							  	            $('#alert-modal').modal('show');
							  	 }

					else {
                             $.each(response.errors, function(field, errorMessage) {
							 $('#' + field + '_error').text(errorMessage);
							
							});
						}
					
	},
	 complete: function() {
         $('#loading-overlay').hide();
         $('body').removeClass('loading');
     },
				error: function(xhr, status, error) {

					if(xhr.responseText){

						$('#alert-modal .modal-title').text('ERROR');
			            $('#alert-modal .modal-body h3').text(xhr.responseText);
			            
			           $('#alert-modal .modal-body i')  .addClass('fas fa-exclamation-circle fa-lg animate__animated animate__shakeX')
		               .css('color', 'red');
			           $('#alert-modal').modal({
			                backdrop: 'static',
			                keyboard: false
			              });
			            $('#alert-modal').modal('show');
					}
						
						else{
							$('#alert-modal .modal-title').text('ERROR');
				            $('#alert-modal .modal-body h3').text('Server not responding please sign-in again');
				            
				            $('#alert-modal .modal-body i').addClass('fas fa-exclamation-circle fa-lg animate__animated animate__shakeX')
			                                               .css('color', 'red');
				            $('#alert-modal').modal({
				                backdrop: 'static',
				                keyboard: false
				              });
				            $('#alert-modal').modal('show');
							
						}
				}
			});
		});
	});




	
	
	</script>
	
	<script>
	function checkDateOfLastConfinement(){
		var date=$("#dateOfLastConfinement").val();
		var dateOfLastConfinement=new Date(date);
		var currentDate= new Date();
		if(dateOfLastConfinement>=currentDate){
		 $('#dateOfLastConfinement_error').text("* Date should be in past or present !");
		}
		else{
			 $('#dateOfLastConfinement_error').text("");
		
		}
		}
	
	
	//-------------Default values----------//
	function setDefaultValues() {
		var  menstrualHistory=$("#menstrualHistory").val();
		var  vaginalDischarge=$("#vaginalDischarge").val();
		var  uvProlapse=$("#uvProlapse").val();
		var  usgAbdomen=$("#usgAbdomen").val();
		var  otherAilment=$("#otherAilment").val();
		var  obstetricsHistory=$("#obstetricsHistory").val();
		
		if (! menstrualHistory) {
			$("#menstrualHistory").val('NAD');

		}
		if (! vaginalDischarge) {
			$("#vaginalDischarge").val('Absent');

		}
		if (! uvProlapse) {
			$("#uvProlapse").val('Absent');

		}
		if (! usgAbdomen) {
			$("#usgAbdomen").val('Not done');

		}
		
		if (! otherAilment) {
			$("#otherAilment").val('NAD');

		}
		if (! obstetricsHistory) {
			$("#obstetricsHistory").val('');

		}
		
		   

	}


	
	
	
	</script>

</body>
</html>